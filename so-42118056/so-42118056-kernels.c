#include <stdio.h>

typedef long long pairset;
pairset d[] = {
18143015731201,
9896678522881,
6598143639553,
17663053135873,
8935679590401,
4675072032769,
17630840881153,
2340757307393,
1378684633089,
8839042826241,
2276332797953,
833223786497,
4449586249729,
1185411104769,
704374767617,
18141975674881,
9895638466561,
6597103583233,
17660972892161,
8933599346689,
4672991789057,
17626680262657,
2336596688897,
1374524014593,
8830721458177,
2268011429889,
824902418433,
4432943382529,
1168768237569,
687731900417,
18141959159809,
9895621951489,
6597087068161,
17596548644865,
8804750589953,
4415294013441,
17594468270081,
2207747932161,
1116826238977,
8798509465601,
2203587182593,
567204642817,
4400731389953,
1104343990273,
558883143681,
17660923346945,
8933549801473,
4672942243841,
17596515614721,
8804717559809,
4415260983297,
17593395052545,
283603107841,
154754088961,
8797436248065,
279442358273,
86168829953,
4399658172417,
142271840257,
77847330817,
17626564657153,
2336481083393,
1374408409089,
17594369179649,
2207648841729,
1116727148545,
17593328992257,
283537047553,
154688028673,
2200367529985,
277295923201,
51810140161,
1101124337665,
140125405185,
43488641025,
8830473732097,
2267763703809,
824654692353,
8798278254593,
2203355971585,
566973431809,
8797238067201,
279244177409,
85970649089,
2200235409409,
277163802625,
51678019585,
551370620929,
71408025601,
39195770881,
4432431415297,
1168256270337,
687219933185,
4400235937793,
1103848538113,
558387691521,
4399195750401,
141809418241,
77384908801,
1100727975937,
139729043457,
43092279297,
551106379777,
71143784449,
38931529729,
18143015601154,
9896678392834,
6598143509506,
17663053005826,
8935679460354,
4675071902722,
17630840751106,
2340757177346,
1378684503042,
8839042696194,
2276332667906,
833223656450,
4449586119682,
1185410974722,
704374637570,
18141975414786,
9895638206466,
6597103323138,
17660972632066,
8933599086594,
4672991528962,
17626680002562,
2336596428802,
1374523754498,
8830721198082,
2268011169794,
824902158338,
4432943122434,
1168767977474,
687731640322,
18141958639618,
9895621431298,
6597086547970,
17596548124674,
8804750069762,
4415293493250,
17594467749890,
2207747411970,
1116825718786,
8798508945410,
2203586662402,
567204122626,
4400730869762,
1104343470082,
558882623490,
17660922306562,
8933548761090,
4672941203458,
17596514574338,
8804716519426,
4415259942914,
17593394012162,
283602067458,
154753048578,
8797435207682,
279441317890,
86167789570,
4399657132034,
142270799874,
77846290434,
17626562576386,
2336479002626,
1374406328322,
17594367098882,
2207646760962,
1116725067778,
17593326911490,
283534966786,
154685947906,
2200365449218,
277293842434,
51808059394,
1101122256898,
140123324418,
43486560258,
8830469570562,
2267759542274,
824650530818,
8798274093058,
2203351810050,
566969270274,
8797233905666,
279240015874,
85966487554,
2200231247874,
277159641090,
51673858050,
551366459394,
71403864066,
39191609346,
4432423092226,
1168247947266,
687211610114,
4400227614722,
1103840215042,
558379368450,
4399187427330,
141801095170,
77376585730,
1100719652866,
139720720386,
43083956226,
551098056706,
71135461378,
38923206658,
18143015600644,
9896678392324,
6598143508996,
17663053005316,
8935679459844,
4675071902212,
17630840750596,
2340757176836,
1378684502532,
8839042695684,
2276332667396,
833223655940,
4449586119172,
1185410974212,
704374637060,
18141942384644,
9895605176324,
6597070292996,
17660906571780,
8933533026308,
4672925468676,
17626547881988,
2336464308228,
1374391633924,
8830456956932,
2267746928644,
824637917188,
4432414640132,
1168239495172,
687203158020,
18141942124548,
9895604916228,
6597070032900,
17596482064388,
8804684009476,
4415227432964,
17594335629316,
2207615291396,
1116693598212,
8798244704260,
2203322421252,
566939881476,
4400202387460,
1103814987780,
558354141188,
17660905791492,
8933532246020,
4672924688388,
17596481544196,
8804683489284,
4415226912772,
17593261891588,
283469946884,
154620928004,
8797170966532,
279177076740,
85903548420,
4399128649732,
141742317572,
77317808132,
17626546061316,
2336462487556,
1374389813252,
17594334068740,
2207613730820,
1116692037636,
17593260851204,
283468906500,
154619887620,
2200101208068,
277029601284,
51543818244,
1100593774596,
139594842116,
42958077956,
8830453055492,
2267743027204,
824634015748,
8798241062916,
2203318779908,
566936240132,
8797167845380,
279173955588,
85900427268,
2200099127300,
277027520516,
51541737476,
550837977092,
70875381764,
38663127044,
4432406577156,
1168231432196,
687195095044,
4400194584580,
1103807184900,
558346338308,
4399121367044,
141735034884,
77310525444,
1100587532292,
139588599812,
42951835652,
550833815556,
70871220228,
38658965508,
18141975413256,
9895638204936,
6597103321608,
17660972630536,
8933599085064,
4672991527432,
17626680001032,
2336596427272,
1374523752968,
8830721196552,
2268011168264,
824902156808,
4432943120904,
1168767975944,
687731638792,
18141942383624,
9895605175304,
6597070291976,
17660906570760,
8933533025288,
4672925467656,
17626547880968,
2336464307208,
1374391632904,
8830456955912,
2267746927624,
824637916168,
4432414639112,
1168239494152,
687203157000,
18141941993480,
9895604785160,
6597069901832,
17592321314824,
8796362510344,
4398584434696,
17592255254536,
2199293792264,
1100050599944,
8796164329480,
2199161671688,
550296883208,
4398122012680,
1099654238216,
550032642056,
17660905660424,
8933532114952,
4672924557320,
17592320794632,
8796361990152,
4398583914504,
17592221704200,
275148447752,
137977929736,
8796130779144,
275016327176,
69260550152,
4398088462344,
137581568008,
68996309000,
17626545930248,
2336462356488,
1374389682184,
17592253693960,
2199292231688,
1100049039368,
17592220663816,
275147407368,
137976889352,
2199061020680,
274949226504,
34900819976,
1099553587208,
137514467336,
34636578824,
8830452924424,
2267742896136,
824633884680,
8796160688136,
2199158030344,
550293241864,
8796127657992,
275013206024,
69257429000,
2199058939912,
274947145736,
34898739208,
549797789704,
68795006984,
34502377480,
4432406446088,
1168231301128,
687194963976,
4398114209800,
1099646435336,
550024839176,
4398081179656,
137574285320,
68989026312,
1099547344904,
137508225032,
34630336520,
549793628168,
68790845448,
34498215944,
18141958636048,
9895621427728,
6597086544400,
17596548121104,
8804750066192,
4415293489680,
17594467746320,
2207747408400,
1116825715216,
8798508941840,
2203586658832,
567204119056,
4400730866192,
1104343466512,
558882619920,
18141942121488,
9895604913168,
6597070029840,
17596482061328,
8804684006416,
4415227429904,
17594335626256,
2207615288336,
1116693595152,
8798244701200,
2203322418192,
566939878416,
4400202384400,
1103814984720,
558354138128,
18141941991440,
9895604783120,
6597069899792,
17592321312784,
8796362508304,
4398584432656,
17592255252496,
2199293790224,
1100050597904,
8796164327440,
2199161669648,
550296881168,
4398122010640,
1099654236176,
550032640016,
17596481150992,
8804683096080,
4415226519568,
17592320532496,
8796361728016,
4398583652368,
17592204926992,
17450410000,
9128910864,
8796114001936,
17318289424,
4836040720,
4398071685136,
8732549136,
4571799568,
17594333675536,
2207613337616,
1116691644432,
17592253431824,
2199291969552,
1100048777232,
17592203886608,
17449369616,
9127870480,
2199044243472,
17251188752,
2688565264,
1099536810000,
8665448464,
2424324112,
8798240669712,
2203318386704,
566935846928,
8796160426000,
2199157768208,
550292979728,
8796110880784,
17315168272,
4832919568,
2199042162704,
17249107984,
2686484496,
549781012496,
4370497552,
2290122768,
4400194191376,
1103806791696,
558345945104,
4398113947664,
1099646173200,
550024577040,
4398064402448,
8725266448,
4564516880,
1099530567696,
8659206160,
2418081808,
549776850960,
4366336016,
2285961232,
17660922298912,
8933548753440,
4672941195808,
17596514566688,
8804716511776,
4415259935264,
17593394004512,
283602059808,
154753040928,
8797435200032,
279441310240,
86167781920,
4399657124384,
142270792224,
77846282784,
17660905784352,
8933532238880,
4672924681248,
17596481537056,
8804683482144,
4415226905632,
17593261884448,
283469939744,
154620920864,
8797170959392,
279177069600,
85903541280,
4399128642592,
141742310432,
77317800992,
17660905654304,
8933532108832,
4672924551200,
17592320788512,
8796361984032,
4398583908384,
17592221698080,
275148441632,
137977923616,
8796130773024,
275016321056,
69260544032,
4398088456224,
137581561888,
68996302880,
17596481146912,
8804683092000,
4415226515488,
17592320528416,
8796361723936,
4398583648288,
17592204922912,
17450405920,
9128906784,
8796113997856,
17318285344,
4836036640,
4398071681056,
8732545056,
4571795488,
17593259933728,
283467989024,
154618970144,
17592219877408,
275146620960,
137976102944,
17592203362336,
17448845344,
9127346208,
274898894880,
17217634336,
1614823456,
137464135712,
8631894048,
1350582304,
8797166927904,
279173038112,
85899509792,
8796126871584,
275012419616,
69256642592,
8796110356512,
17314644000,
4832395296,
274896814112,
17215553568,
1612742688,
68744675360,
4336943136,
1216380960,
4399120449568,
141734117408,
77309607968,
4398080393248,
137573498912,
68988239904,
4398063878176,
8724742176,
4563992608,
137457893408,
8625651744,
1344340000,
68740513824,
4332781600,
1212219424,
17626562560576,
2336478986816,
1374406312512,
17594367083072,
2207646745152,
1116725051968,
17593326895680,
283534950976,
154685932096,
2200365433408,
277293826624,
51808043584,
1101122241088,
140123308608,
43486544448,
17626546046016,
2336462472256,
1374389797952,
17594334053440,
2207613715520,
1116692022336,
17593260835904,
283468891200,
154619872320,
2200101192768,
277029585984,
51543802944,
1100593759296,
139594826816,
42958062656,
17626545915968,
2336462342208,
1374389667904,
17592253679680,
2199292217408,
1100049025088,
17592220649536,
275147393088,
137976875072,
2199061006400,
274949212224,
34900805696,
1099553572928,
137514453056,
34636564544,
17594333663296,
2207613325376,
1116691632192,
17592253419584,
2199291957312,
1100048764992,
17592203874368,
17449357376,
9127858240,
2199044231232,
17251176512,
2688553024,
1099536797760,
8665436224,
2424311872,
17593259925568,
283467980864,
154618961984,
17592219869248,
275146612800,
137976094784,
17592203354176,
17448837184,
9127338048,
274898886720,
17217626176,
1614815296,
137464127552,
8631885888,
1350574144,
2200097161280,
277025554496,
51539771456,
2199057104960,
274945310784,
34896904256,
2199040589888,
17247535168,
2684911680,
274895765568,
17214505024,
1611694144,
34384937024,
2189459520,
1149272128,
1100585566272,
139586633792,
42949869632,
1099545509952,
137506390080,
34628501568,
1099528994880,
8657633344,
2416508992,
137456844864,
8624603200,
1343291456,
34380775488,
2185297984,
1145110592,
8830469538432,
2267759510144,
824650498688,
8798274060928,
2203351777920,
566969238144,
8797233873536,
279239983744,
85966455424,
2200231215744,
277159608960,
51673825920,
551366427264,
71403831936,
39191577216,
8830453023872,
2267742995584,
824633984128,
8798241031296,
2203318748288,
566936208512,
8797167813760,
279173923968,
85900395648,
2200099095680,
277027488896,
51541705856,
550837945472,
70875350144,
38663095424,
8830452893824,
2267742865536,
824633854080,
8796160657536,
2199157999744,
550293211264,
8796127627392,
275013175424,
69257398400,
2199058909312,
274947115136,
34898708608,
549797759104,
68794976384,
34502346880,
8798240641152,
2203318358144,
566935818368,
8796160397440,
2199157739648,
550292951168,
8796110852224,
17315139712,
4832891008,
2199042134144,
17249079424,
2686455936,
549780983936,
4370468992,
2290094208,
8797166903424,
279173013632,
85899485312,
8796126847104,
275012395136,
69256618112,
8796110332032,
17314619520,
4832370816,
274896789632,
17215529088,
1612718208,
68744650880,
4336918656,
1216356480,
2200097144960,
277025538176,
51539755136,
2199057088640,
274945294464,
34896887936,
2199040573568,
17247518848,
2684895360,
274895749248,
17214488704,
1611677824,
34384920704,
2189443200,
1149255808,
550829752448,
70867157120,
38654902400,
549789696128,
68786913408,
34494283904,
549773181056,
4362666112,
2282291328,
68737368192,
4329635968,
1209073792,
34378678400,
2183200896,
1143013504,
4432423027456,
1168247882496,
687211545344,
4400227549952,
1103840150272,
558379303680,
4399187362560,
141801030400,
77376520960,
1100719588096,
139720655616,
43083891456,
551097991936,
71135396608,
38923141888,
4432406512896,
1168231367936,
687195030784,
4400194520320,
1103807120640,
558346274048,
4399121302784,
141734970624,
77310461184,
1100587468032,
139588535552,
42951771392,
550833751296,
70871155968,
38658901248,
4432406382848,
1168231237888,
687194900736,
4398114146560,
1099646372096,
550024775936,
4398081116416,
137574222080,
68988963072,
1099547281664,
137508161792,
34630273280,
549793564928,
68790782208,
34498152704,
4400194130176,
1103806730496,
558345883904,
4398113886464,
1099646112000,
550024515840,
4398064341248,
8725205248,
4564455680,
1099530506496,
8659144960,
2418020608,
549776789760,
4366274816,
2285900032,
4399120392448,
141734060288,
77309550848,
4398080336128,
137573441792,
68988182784,
4398063821056,
8724685056,
4563935488,
137457836288,
8625594624,
1344282880,
68740456704,
4332724480,
1212162304,
1100585517312,
139586584832,
42949820672,
1099545460992,
137506341120,
34628452608,
1099528945920,
8657584384,
2416460032,
137456795904,
8624554240,
1343242496,
34380726528,
2185249024,
1145061632,
550829719808,
70867124480,
38654869760,
549789663488,
68786880768,
34494251264,
549773148416,
4362633472,
2282258688,
68737335552,
4329603328,
1209041152,
34378645760,
2183168256,
1142980864,
};

const short factorization_length = 9;
const short max_first_index = 104;

int main() {
  int num_matchings = sizeof(d)/sizeof(d[0]);
  const short max_matching_index = num_matchings - 1;
  for (short i = 0; i <= max_matching_index; ++i) {
    // printf("%d %lld\n", i, d[i]);
  }

  short x_index[factorization_length + 1]; x_index[0] = -1;
  pairset x[factorization_length + 1];
  pairset x_union[factorization_length + 1]; x_union[0] = 0;

  int count = 0; // Enough for k=5: count 1225566720
 // b1:
  short l = 1;
 b2:
  // Beginning of level l
  if (l > factorization_length) {
    // We have a solution; do something with it.
    // std::cout << "Found a factorization" << std::endl;
    ++count;
    // And then
    goto b5;
  }
  x_index[l] = x_index[l - 1] + 1;
  x[l] = d[x_index[l]];
 b3:
  // Try current value of [l]
  if (l == 1) {
    printf("Trying value %lld for position %d (have found %d so far)\n", x[l], l, count);
    //
    if (x_index[l] > max_first_index) {
      goto b4;
    }
  }
  if ((x[l] & x_union[l - 1]) == 0 && !(x_index[l] == max_matching_index && l < factorization_length)) {
    x_union[l] = x_union[l - 1] | x[l];
    ++l;
    goto b2;
  }
 b4:
  // Try next option for x[l], if possible
  if (x_index[l] < max_matching_index) {
    ++x_index[l];
    x[l] = d[x_index[l]];
    goto b3;
  }
 b5:
  // Backtrack: We've run out of options for x[l]. So we need to try next values of x[l-1].
  --l;
  if (l > 0) {
    goto b4;
  }

  printf("The backtracking gave %d factorizations\n", count);
}
